# Architecture Decision Records (ADR)

本目录包含TestMind项目的所有架构决策记录。

## 什么是ADR？

架构决策记录（Architecture Decision Record）是记录软件架构重要决策的文档。它帮助团队：
- 理解"为什么"做出某个决策
- 评估决策的后果和权衡
- 在未来回顾和质疑决策时有据可查
- 避免重复讨论已解决的问题

## ADR索引

| 编号 | 标题 | 状态 | 日期 | 影响范围 |
|------|------|------|------|---------|
| [0001](./0001-use-tree-sitter-for-parsing.md) | 使用Tree-sitter作为代码解析器 | ✅ 已接受 | 2025-09 | 核心架构 |
| [0002](./0002-lru-cache-strategy.md) | 使用LRU缓存策略优化文件读取 | ✅ 已接受 | 2025-10-18 | 性能优化 |
| [0003](./0003-vitest-over-jest.md) | 选择Vitest而非Jest作为测试框架 | ✅ 已接受 | 2025-09 | 开发工具 |
| [0004](./0004-analysis-only-benchmark.md) | 性能基准仅验证分析阶段 | ✅ 已接受 | 2025-10-18 | 测试策略 |

## 按类别分类

### 核心架构
- ADR 0001: Tree-sitter解析器

### 性能优化
- ADR 0002: LRU缓存
- ADR 0004: 分析阶段性能基准

### 开发工具
- ADR 0003: Vitest测试框架

## 按状态分类

### ✅ 已接受 (4个)
- 0001, 0002, 0003, 0004

### 🔶 提议中 (0个)
- 无

### ❌ 已拒绝 (0个)
- 无

### 🔄 已替代 (0个)
- 无

## ADR模板

创建新ADR时，使用以下模板：

```markdown
# ADR XXXX: [决策标题]

## 状态
[提议中/已接受/已拒绝/已替代] (日期)

## 背景
[描述需要做出决策的上下文和问题]

## 决策
[简明阐述决策内容]

## 备选方案考虑
[列出并评估其他可行方案]

## 权衡分析
[使用矩阵或表格系统对比方案]

## 决策理由
[解释为何选择该方案，遵循哪些4.md原则]

## 后果
- 正面影响：[列出]
- 负面影响：[列出]
- 风险与缓解：[描述]

## 技术债务（如有）
[记录决策引入的技术债务]

## 监控指标
[如何验证决策是否成功]

## 相关ADR
[链接到相关决策]

## 参考资料
[支持决策的资料]
```

## 4.md原则在ADR中的体现

每个ADR都应体现：

1. **经济学思维**：
   - 量化成本（实施+维护）
   - 量化收益（短期+长期）
   - 计算ROI

2. **多方案评估**：
   - 至少2-3个备选方案
   - 系统化评估矩阵
   - 明确权衡理由

3. **系统性思维**：
   - 影响分析（爆炸半径）
   - 依赖关系
   - 长期后果

4. **技术债务管理**：
   - 识别决策引入的债务
   - Fowler四象限分类
   - 偿还计划

## 何时创建ADR？

创建ADR的判断标准：

**必须创建**（P0）：
- 影响核心架构的决策
- 引入新的主要依赖
- 重大技术栈选型
- 影响多个团队的决策

**应该创建**（P1）：
- 性能优化策略
- 安全相关决策
- 数据模型设计
- API设计

**可选创建**（P2）：
- 代码组织方式
- 命名约定
- 开发工具选择

## 参考资料

- [4.md - 首席工程师行动手册](../../4.md)
- [Why you should be using ADR](https://www.redhat.com/en/blog/architecture-decision-records)
- [ADR GitHub组织](https://adr.github.io/)

---

**维护者**：AI Engineering Team  
**最后更新**：2025-10-18





